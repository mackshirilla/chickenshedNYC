"use strict";(()=>{var D=document.getElementById("firstNameInput"),Q=document.getElementById("firstNameError");function Se(){return D.hasAttribute("required")&&D.value.trim()===""?(Q.textContent="First name required",Q.style.display="block",D.classList.add("error"),!1):(Q.textContent="",Q.style.display="none",D.classList.remove("error"),!0)}D&&D.addEventListener("blur",Se);var x=document.getElementById("lastNameInput"),X=document.getElementById("lastNameError");function qe(){return x.hasAttribute("required")&&x.value.trim()===""?(X.textContent="Last name required",X.style.display="block",x.classList.add("error"),!1):(X.textContent="",X.style.display="none",x.classList.remove("error"),!0)}x&&x.addEventListener("blur",qe);var E=document.getElementById("emailInput"),v=document.getElementById("emailError");function Ne(){let n=/^\S+@\S+\.\S+$/;return E.hasAttribute("required")&&E.value.trim()===""?(v.textContent="Email is required",v.style.display="block",E.classList.add("error"),!1):E.value.trim()!==""&&!n.test(E.value)?(v.textContent="Please enter a valid email",v.style.display="block",E.classList.add("error"),!1):(v.textContent="",v.style.display="none",E.classList.remove("error"),!0)}E&&E.addEventListener("blur",Ne);var m=document.getElementById("phoneInput"),T=document.getElementById("phoneError");function Ee(n){let e=n.replace(/\D/g,"");return e.length===0?"":e.length<4?`(${e}`:e.length<7?`(${e.slice(0,3)}) ${e.slice(3)}`:`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6,10)}`}function Ae(){let n=/^\D*(\d{3})\D*\D*(\d{3})\D*(\d{4})\D*$/;return m.required&&m.value.trim()===""?(T.textContent="Phone is required",T.style.display="block",m.classList.add("error"),!1):m.value.trim()!==""&&!n.test(m.value)?(T.textContent="Please enter a valid phone number",T.style.display="block",m.classList.add("error"),!1):(m.value=Ee(m.value),T.textContent="",T.style.display="none",m.classList.remove("error"),!0)}m&&m.addEventListener("input",n=>{let e=n.target;e.value=Ee(e.value),Ae()});var H=document.getElementById("dobInput"),Z=document.getElementById("dobError");function Ce(){return H.hasAttribute("required")&&H.value.trim()===""?(Z.textContent="Date of Birth is required",Z.style.display="block",H.classList.add("error"),!1):(Z.textContent="",Z.style.display="none",H.classList.remove("error"),!0)}H&&H.addEventListener("blur",Ce);var M=document.getElementById("genderInput"),ee=document.getElementById("genderError");function we(){return M.hasAttribute("required")&&M.value.trim()===""?(ee.textContent="Gender is required",ee.style.display="block",M.classList.add("error"),!1):(ee.textContent="",ee.style.display="none",M.classList.remove("error"),!0)}M&&M.addEventListener("blur",we);var k=document.getElementById("schoolInput"),te=document.getElementById("schoolError");function Pe(){return k.hasAttribute("required")&&k.value.trim()===""?(te.textContent="School name is required",te.style.display="block",k.classList.add("error"),!1):(te.textContent="",te.style.display="none",k.classList.remove("error"),!0)}k&&k.addEventListener("blur",Pe);var S=document.getElementById("gradeInput"),ne=document.getElementById("gradeError");function Re(){return S.hasAttribute("required")&&S.value.trim()==="N/A"?(ne.textContent="Grade is required",ne.style.display="block",S.classList.add("error"),!1):(ne.textContent="",ne.style.display="none",S.classList.remove("error"),!0)}S&&S.addEventListener("blur",Re);var le=document.getElementById("ethnicityInput"),b=document.getElementById("ethnicityError");function Oe(){return le.hasAttribute("required")&&le.value.trim()===""?(b.textContent="Ethnicity is required",b.style.display="block",le.classList.add("error"),!1):(b.textContent="",b.style.display="none",b.classList.remove("error"),!0)}b&&le.addEventListener("blur",Oe);var q=document.getElementById("healthInput"),se=document.getElementById("healthError");function $e(){return q.hasAttribute("required")&&q.value.trim()===""?(se.textContent="This field is required",se.style.display="block",q.classList.add("error"),!1):(se.textContent="",se.style.display="none",q.classList.remove("error"),!0)}q&&q.addEventListener("blur",$e);var N=document.getElementById("emergencyContact"),oe=document.getElementById("emergencyError");function Ue(){return N.hasAttribute("required")&&N.value.trim()===""?(oe.textContent="This field is required",oe.style.display="block",N.classList.add("error"),!1):(oe.textContent="",oe.style.display="none",N.classList.remove("error"),!0)}N&&N.addEventListener("blur",Ue);var A=document.getElementById("dismissal"),re=document.getElementById("dismissalError");function Fe(){return A.hasAttribute("required")&&A.value.trim()===""?(re.textContent="This field is required",re.style.display="block",A.classList.add("error"),!1):(re.textContent="",re.style.display="none",A.classList.remove("error"),!0)}A&&A.addEventListener("blur",Fe);var f=document.getElementById("additionalEmail"),B=document.getElementById("additionalEmailError");function Je(){let n=/^\S+@\S+\.\S+$/;return f.hasAttribute("required")&&f.value.trim()===""?(B.textContent="Email is required",B.style.display="block",f.classList.add("error"),!1):f.value.trim()!==""&&!n.test(f.value)?(B.textContent="Please enter a valid email",B.style.display="block",f.classList.add("error"),!1):(B.textContent="",B.style.display="none",f.classList.remove("error"),!0)}f&&f.addEventListener("blur",Je);var C=document.getElementById("interestInput"),ie=document.getElementById("interestError");function pe(){return C.hasAttribute("required")&&C.value.trim()===""?(ie.textContent="This field is required",ie.style.display="block",C.classList.add("error"),!1):(ie.textContent="",ie.style.display="none",C.classList.remove("error"),!0)}C&&C.addEventListener("blur",pe);var p=[],ae=null;async function Ge(n){let e=await fetch(`https://x8ki-letl-twmt.n7.xano.io/api:2gnTJ2I8/student_profiles?guardianUserID=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw new Error(t.message||"An error occurred")}return(await e.json()).allStudentProfiles}async function je(){let n=localStorage.getItem("profile"),e=n?JSON.parse(n):null,o=e==null?void 0:e.userID,t=document.getElementById("loadingAnimation"),s=document.getElementById("registrationFormWrapper"),y=document.getElementById("NoStudentProfiles");s.style.display="none",y.style.display="none",t.style.display="block";try{let l=await Ge(o);if(l.length>0){let r=document.getElementById("studentList"),a=document.getElementById("studentItem");r.innerHTML="",l.forEach(d=>{let L=a.cloneNode(!0),I=L.querySelector(".fs_checkbox-1_label"),i=L.querySelector('input[type="checkbox"]');I&&(I.textContent=`${d.firstName} ${d.lastName}`),i&&(i.value=d.id.toString(),i.addEventListener("change",()=>{if(i.checked)p.push(d);else{let g=p.findIndex(h=>h.id===d.id);g!==-1&&p.splice(g,1)}console.log("Selected Student Profiles:",p)})),r.appendChild(L)}),a.style.display="none",r.style.display="grid",t.style.display="none",s.style.display="block"}else t.style.display="none",y.style.display="block",s.style.display="none"}catch(l){console.error("An error occurred while fetching student profiles:",l),alert("An error occurred while fetching student profiles.")}}function _e(){document.querySelectorAll('input[name="paymentType"]').forEach(e=>{e.addEventListener("change",function(){if(this.checked)if(ae=this.getAttribute("priceid"),console.log(`Selected payment type: ${this.value}`),console.log(`Updated priceID: ${ae}`),this.value==="Deposit"){let o=document.getElementById("depositOnly");o.value="true";let t=document.getElementById("toggleNoOverflow");t.style.height="16rem"}else{let o=document.getElementById("depositOnly");o.value="false";let t=document.getElementById("toggleNoOverflow");t.style.height="0rem"}})})}function We(){let n=document.getElementById("submitButton"),e=document.getElementById("studentListError"),o=document.getElementById("paymentError"),t=document.getElementById("submitError"),s=document.getElementById("requestLoadingAnimation");n&&n.addEventListener("click",async y=>{y.preventDefault();let l=!1;e&&(e.style.display="none"),o&&(o.style.display="none"),t&&(t.style.display="none"),p.length===0&&(e&&(e.style.display="block",e.innerText="This field is required"),l=!0),ae||(o&&(o.style.display="block",o.innerText="This field is required"),l=!0);let r=document.getElementById("interestInput"),a=document.getElementById("interestError"),d=r.value;if(pe(d)||(a?(a.style.display="block",a.innerText="This field is required"):a.style.display="none",l=!0),l){t&&(t.style.display="block"),t&&(t.innerText="Please make sure all required fields are filled");return}let I=localStorage.getItem("profile"),i=I?JSON.parse(I):null,g=i==null?void 0:i.userID,h=i==null?void 0:i.firstName,F=i==null?void 0:i.lastName,w=document.getElementById("finAid"),P=document.getElementById("finPlan"),R=document.getElementById("contactListID"),O=document.getElementById("sessionID"),$=document.getElementById("followUpEmailID"),U=document.getElementById("color"),J=document.getElementById("imageURL"),G=document.getElementById("program"),j=document.getElementById("workshop"),_=document.getElementById("sessionTime"),W=document.getElementById("sessionDay"),V=document.getElementById("depositOnly"),Y=document.getElementById("startDate"),z=document.getElementById("endDate"),K=document.querySelectorAll('input[name="paymentType"]:checked')[0],de=K?K.getAttribute("unitAmount"):null,ce=p.map(u=>u.id),ue=p.map(u=>`${u.firstName} ${u.lastName}`),me=U?U.value:"",c=J?J.value:"",Ie=G?G.value:"",ge=j?j.value:"",Le=_?_.value:"",he=W?W.value:"",ve=w?w.checked:!1,Te=P?P.checked:!1,Be=V?V.value:"false",be=$?$.value:"",De=O?O.value:"",xe=R?R.value:"",He=Y?Y.value:"",Me=z?z.value:"",ke=xe.split(",").map(u=>u.trim()).filter(u=>u);s&&(s.style.display="block");try{if((await fetch("https://x8ki-letl-twmt.n7.xano.io/api:2gnTJ2I8/cart_items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userID:g,firstName:h,lastName:F,studentIDs:ce,studentNames:ue,priceID:ae,unitAmount:de,color:me,imageURL:c,program:Ie,workshop:ge,sessionTime:Le,sessionDay:he,finAid:ve,finPlan:Te,depositOnly:Be,quantity:p.length,emailFollowUpID:be,sessionID:De,contactLists:ke,startDate:He,endDate:Me})})).ok)s&&(s.style.display="none"),window.location.href="/my-account/cart";else throw new Error("An error occurred while submitting the form")}catch(u){console.error(u),s&&(s.style.display="none"),t&&(t.style.display="block")}})}function Ve(){let n=document.getElementById("freeSubmitButton"),e=document.getElementById("studentListError"),o=document.getElementById("submitError"),t=document.getElementById("freeRequestLoadingAnimation");n&&n.addEventListener("click",async s=>{s.preventDefault();let y=!1;if(e&&(e.style.display="none"),o&&(o.style.display="none"),p.length===0&&(e&&(e.style.display="block",e.innerText="This field is required"),y=!0),y){o&&(o.style.display="block",o.innerText="Please make sure all required fields are filled");return}let l=localStorage.getItem("profile"),r=l?JSON.parse(l):null,a=r==null?void 0:r.userID,d=r==null?void 0:r.firstName,L=r==null?void 0:r.lastName,I=document.getElementById("contactListID"),i=document.getElementById("sessionID"),g=document.getElementById("followUpEmailID"),h=document.getElementById("color"),F=document.getElementById("imageURL"),w=document.getElementById("program"),P=document.getElementById("workshop"),R=document.getElementById("sessionTime"),O=document.getElementById("sessionDay"),$=document.getElementById("startDate"),U=document.getElementById("endDate"),J=p.map(c=>c.id),G=p.map(c=>`${c.firstName} ${c.lastName}`),j=h?h.value:"",_=F?F.value:"",W=w?w.value:"",V=P?P.value:"",Y=R?R.value:"",z=O?O.value:"",ye=g?g.value:"",K=i?i.value:"",de=I?I.value:"",ce=$?$.value:"",ue=U?U.value:"",me=de.split(",").map(c=>c.trim()).filter(Boolean);t&&(t.style.display="block");try{if((await fetch("https://x8ki-letl-twmt.n7.xano.io/api:2gnTJ2I8/FREE_REGISTRATION",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userID:a,firstName:d,lastName:L,studentIDs:J,studentNames:G,color:j,imageURL:_,program:W,workshop:V,sessionTime:Y,sessionDay:z,emailFollowUpID:ye,sessionID:K,contactLists:me,startDate:ce,endDate:ue})})).ok)window.location.href="/successful-checkout";else throw new Error("An error occurred while submitting the form")}catch(c){console.error(c),o&&(o.style.display="block")}finally{t&&(t.style.display="none")}})}document.addEventListener("DOMContentLoaded",function(){let n=document.getElementById("NotLoggedIn"),e=document.getElementById("registrationFormWrapper"),o=document.getElementById("loadingAnimation");localStorage.getItem("profile")===null?(n&&(n.style.display="block"),e&&(e.style.display="none",o.style.display="none")):(n&&(n.style.display="none"),e&&(e.style.display="block",je()));let t=document.getElementById("finAid"),s=document.getElementById("finPlan"),y=document.querySelector('input[name="paymentType"][value="Deposit"]'),l=Array.from(document.querySelectorAll('input[name="paymentType"]:not([value="Deposit"])'));t&&t.addEventListener("change",()=>{(t.checked||s&&s.checked)&&y.click()}),s&&s.addEventListener("change",()=>{(s.checked||t&&t.checked)&&y.click()}),l.forEach(d=>{d.addEventListener("change",()=>{d.checked&&(t&&(t.checked=!1),s&&(s.checked=!1))})}),_e(),We(),Ve();let r=document.getElementById("finAidText");t&&t.addEventListener("change",()=>{t.checked?r.innerText="Yes":r.innerText="No"});let a=document.getElementById("finPlanText");s&&s.addEventListener("change",()=>{s.checked?a.innerText="Yes":a.innerText="No"})});var fe=document.getElementById("addStudent");fe&&fe.addEventListener("click",()=>{localStorage.setItem("redirectURL",window.location.href),window.location.href="/create-account/add-student"});})();
