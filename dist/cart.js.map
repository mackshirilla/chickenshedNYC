{
  "version": 3,
  "sources": ["../bin/live-reload.js", "../src/cart.ts"],
  "sourcesContent": ["new EventSource(`${SERVE_ORIGIN}/esbuild`).addEventListener('change', () => location.reload());\n", "// Function to retrieve the user ID from local storage\nfunction getUserIdFromLocalStorage(): string | null {\n  const profile = localStorage.getItem('profile');\n  if (profile) {\n    const { userID } = JSON.parse(profile);\n    return userID;\n  }\n  return null;\n}\n\n// Perform the GET request to fetch cart items\nasync function fetchCartItems(): Promise<unknown[]> {\n  const userID = getUserIdFromLocalStorage();\n\n  if (!userID) {\n    // Navigate the user to /login if userID is not found\n    window.location.href = '/login';\n    return [];\n  }\n\n  const endpoint = `https://x8ki-letl-twmt.n7.xano.io/api:2gnTJ2I8/cart_items?userID=${userID}`;\n\n  const cartLoadingAnimation = document.getElementById('cartLoading') as HTMLDivElement | null;\n  if (cartLoadingAnimation) {\n    cartLoadingAnimation.style.display = 'block'; // Show the loading animation\n  }\n\n  const noItemsDiv = document.getElementById('noItems') as HTMLDivElement | null;\n  if (noItemsDiv) {\n    noItemsDiv.style.display = 'none'; // Hide the \"noItems\" div initially\n  }\n\n  try {\n    const response = await fetch(endpoint);\n    if (!response.ok) {\n      throw new Error('Unable to fetch cart items.');\n    }\n    const data = await response.json();\n\n    if (data.length === 0) {\n      if (noItemsDiv) {\n        noItemsDiv.style.display = 'flex'; // Show the \"noItems\" div if there are no items returned\n        // hide the submitButton\n        const submitButton = document.getElementById('submitButton') as HTMLButtonElement | null;\n        if (submitButton) {\n          submitButton.style.display = 'none';\n        }\n      }\n    }\n\n    return data;\n  } catch (error) {\n    console.error(error);\n    return [];\n  } finally {\n    // Hide the loading animation after 1 second\n    if (cartLoadingAnimation) {\n      cartLoadingAnimation.style.display = 'none';\n    }\n  }\n}\n\n// Display the cart items in the HTML\nfunction displayCartItems(cartItems: any[]): void {\n  const cartListElement = document.getElementById('cartList');\n\n  if (!cartListElement) {\n    console.error('Cart list element not found.');\n    return;\n  }\n\n  // Clear the cart list\n  cartListElement.innerHTML = '';\n\n  const cartItemTemplate = document.getElementById('cartItem');\n  if (!cartItemTemplate) {\n    console.error('Cart item template not found.');\n    return;\n  }\n\n  // Remove the template from the DOM\n  cartItemTemplate.remove();\n\n  let subtotal = 0; // Initialize subtotal\n\n  cartItems.forEach((item) => {\n    // Clone the template\n    const clonedTemplate = cartItemTemplate.cloneNode(true) as HTMLDivElement;\n\n    // Set the relevant information in the cloned template\n    const programNameElement = clonedTemplate.querySelector('#programName') as HTMLDivElement;\n    programNameElement.textContent = item.program;\n\n    const workshopNameElement = clonedTemplate.querySelector('#workshopName') as HTMLDivElement;\n    workshopNameElement.textContent = item.workshop;\n\n    const sessionDayElement = clonedTemplate.querySelector('#sessionDay') as HTMLDivElement;\n    sessionDayElement.textContent = item.sessionDay;\n\n    const sessionTimeElement = clonedTemplate.querySelector('#sessionTime') as HTMLDivElement;\n    sessionTimeElement.textContent = item.sessionTime;\n\n    const unitPriceElement = clonedTemplate.querySelector('#unitPrice') as HTMLDivElement;\n    unitPriceElement.textContent = `$${item.unitAmount.toFixed(2)}`;\n\n    const depositBadgeElement = clonedTemplate.querySelector('#depositBadge') as HTMLDivElement;\n    const finAidBadgeElement = clonedTemplate.querySelector('#finAidBadge') as HTMLDivElement;\n    const paymentPlanBadgeElement = clonedTemplate.querySelector(\n      '#paymentPlanBadge'\n    ) as HTMLDivElement;\n    const removeFromCartElement = clonedTemplate.querySelector('#removeFromCart') as HTMLDivElement;\n\n    depositBadgeElement.style.display = item.depositOnly ? 'block' : 'none';\n    finAidBadgeElement.style.display = item.finAid ? 'block' : 'none';\n    paymentPlanBadgeElement.style.display = item.finPlan ? 'block' : 'none';\n    removeFromCartElement.style.backgroundColor = item.color;\n    removeFromCartElement.setAttribute('data-item-id', item.id); // Set the item ID as a data attribute\n\n    // Set up event listener for the \"removeFromCart\" button\n    removeFromCartElement.addEventListener('click', async (event) => {\n      event.preventDefault(); // Prevent the default anchor tag behavior\n\n      const itemId = event.currentTarget.getAttribute('data-item-id');\n      if (itemId) {\n        await removeFromCart(itemId);\n      }\n    });\n\n    // Set color to badges and remove from cart element\n    if (item.finAid) {\n      finAidBadgeElement.style.backgroundColor = item.color;\n      finAidBadgeElement.style.display = 'block';\n    }\n    if (item.finPlan) {\n      paymentPlanBadgeElement.style.backgroundColor = item.color;\n      paymentPlanBadgeElement.style.display = 'block';\n    }\n    if (item.depositOnly) {\n      depositBadgeElement.style.backgroundColor = item.color;\n      depositBadgeElement.style.display = 'block';\n    }\n\n    const unitTotalAmount = Number(item.unitAmount) * Number(item.quantity);\n\n    const studentNamesElement = clonedTemplate.querySelector('#studentNames') as HTMLDivElement;\n    studentNamesElement.textContent = item.studentNames.join(', ');\n\n    const untitTotalElement = clonedTemplate.querySelector('#untitTotal') as HTMLDivElement;\n    untitTotalElement.textContent = `$${unitTotalAmount.toFixed(2)}`;\n\n    subtotal += unitTotalAmount; // Add to subtotal\n\n    const cartImageElement = clonedTemplate.querySelector('#cartImage') as HTMLImageElement;\n    if (item.imageURL) {\n      cartImageElement.src = item.imageURL;\n    } else {\n      cartImageElement.style.display = 'none';\n    }\n\n    // Add the filled template to the cart list\n    cartListElement.appendChild(clonedTemplate);\n  });\n\n  // Display the subtotal in the HTML\n  const subtotalElement = document.getElementById('subtotal') as HTMLDivElement | null;\n  if (subtotalElement) {\n    subtotalElement.textContent = `$${subtotal.toFixed(2)}`;\n  } else {\n    console.error('Subtotal element not found.');\n  }\n}\n\n// Function to remove an item from the cart\nasync function removeFromCart(itemId: string): Promise<void> {\n  const endpoint = `https://x8ki-letl-twmt.n7.xano.io/api:2gnTJ2I8/cart_items/${itemId}`;\n\n  try {\n    const response = await fetch(endpoint, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      throw new Error('Unable to remove item from the cart.');\n    }\n\n    //refresh the page\n    window.location.reload();\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// Set up event listeners for the \"removeFromCart\" buttons\nconst removeFromCartButtons = document.querySelectorAll('.remove-cart-item');\nremoveFromCartButtons.forEach((button) => {\n  button.addEventListener('click', async (event) => {\n    event.preventDefault(); // Prevent the default anchor tag behavior\n\n    const itemId = event.currentTarget.getAttribute('data-item-id');\n    if (itemId) {\n      await removeFromCart(itemId);\n    }\n  });\n});\n\n// Call the fetchCartItems function when the page loads\nwindow.onload = async () => {\n  const cartLoadingAnimation = document.getElementById('cartLoading') as HTMLDivElement | null;\n  if (cartLoadingAnimation) {\n    cartLoadingAnimation.style.display = 'block'; // Show the cart loading animation initially\n  }\n\n  try {\n    const cartItems = await fetchCartItems();\n    displayCartItems(cartItems);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    setTimeout(() => {\n      if (cartLoadingAnimation) {\n        cartLoadingAnimation.style.display = 'none'; // Hide the cart loading animation after 1 second\n      }\n    }, 1000);\n  }\n};\n\n// ------------------------------- Handle Checkout -------------------------------\n\n// Function to create the checkout session and navigate to the checkout URL\nasync function createCheckoutSession(cartItems: any[]) {\n  const lineItems = cartItems.map((item, index) => ({\n    price: item.priceID,\n    quantity: item.quantity,\n  }));\n\n  // Retrieve the profile object from local storage\n  const profile = JSON.parse(localStorage.getItem('profile') || '');\n\n  // Extract the necessary profile information\n  const { id, userID, firstName, lastName, email, phoneNumber, image } = profile;\n\n  // Create the metadata object\n  const metadata = {\n    id,\n    userID,\n    firstName,\n    lastName,\n    email,\n    phoneNumber,\n    image: image?.url || '', // Include the image URL or an empty string if not available\n    checkoutCategory: 'registration',\n  };\n\n  const sessionData = {\n    line_items: lineItems,\n    mode: 'payment',\n    success_url: 'https://chickenshed.webflow.io/successful-checkout',\n    cancel_url: window.location.href,\n    metadata: metadata,\n  };\n\n  const endpoint = 'https://x8ki-letl-twmt.n7.xano.io/api:lRsgmoHt/sessions';\n\n  const checkoutLoadingAnimation = document.getElementById(\n    'checkoutLoadingAnimation'\n  ) as HTMLDivElement | null;\n  if (checkoutLoadingAnimation) {\n    checkoutLoadingAnimation.style.display = 'block'; // Show the loading animation\n  }\n\n  try {\n    const response = await fetch(endpoint, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(sessionData),\n    });\n\n    if (!response.ok) {\n      throw new Error('Unable to create checkout session.');\n    }\n\n    const data = await response.json();\n    const checkoutUrl = data.url;\n\n    // Navigate the user to the checkout URL\n    window.location.href = checkoutUrl;\n  } catch (error) {\n    console.error(error);\n  } finally {\n    setTimeout(() => {\n      if (checkoutLoadingAnimation) {\n        checkoutLoadingAnimation.style.display = 'none';\n      }\n    }, 1000);\n  }\n}\n\n// Add click event listener to submitButton\ndocument.querySelector('#submitButton')?.addEventListener('click', async function () {\n  const checkoutLoadingAnimation = document.getElementById(\n    'checkoutLoadingAnimation'\n  ) as HTMLDivElement | null;\n  if (checkoutLoadingAnimation) {\n    checkoutLoadingAnimation.style.display = 'block'; // Show the loading animation\n  }\n\n  try {\n    const cartItems = await fetchCartItems();\n    await createCheckoutSession(cartItems);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    if (checkoutLoadingAnimation) {\n      checkoutLoadingAnimation.style.display = 'none'; // Hide the loading animation\n    }\n  }\n});\n"],
  "mappings": "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",
  "names": []
}
