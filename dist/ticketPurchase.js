"use strict";(()=>{var p=document.getElementById("submitButton");p&&p.addEventListener("click",f);var o=document.getElementById("needsAssistance");o.addEventListener("change",I);function f(c){c.preventDefault();let s=document.getElementById("needsAssistance"),a={performanceDate:document.getElementById("performanceDate").value,performanceTime:document.getElementById("performanceTime").value,performanceName:document.getElementById("performanceName").value,performanceID:document.getElementById("performanceID").value,successURL:document.getElementById("successURL").value,cancelURL:window.location.href,assistanceMessage:document.getElementById("assistanceMessage").value,checkoutCategory:"ticket",needsAssistance:s.checked?"true":"false",userID:"",sendGridFollowUpID:document.getElementById("sendGridFollowUpID").value,sendGridContactList:document.getElementById("sendGridContactList").value,childrenAttending:document.getElementById("childrenAttending").value},i=localStorage.getItem("profile");if(i){let e=JSON.parse(i);e&&typeof e.userID=="number"&&(a.userID=e.userID.toString())}let l=[],u=!1;document.querySelectorAll('input[fs-inputcounter-element^="input"]').forEach(e=>{let m=parseInt(e.value);if(m>0){let d=e.getAttribute("priceid");d&&(l.push({price:d,quantity:m}),u=!0)}});let t=document.getElementById("errorMessage");if(t){if(!u){t.textContent="Please select a ticket tier.",t.style.display="block";return}t.style.display="none"}let r=document.getElementById("loadingWrapper");r&&(r.style.display="block");let g={success_url:a.successURL,cancel_url:a.cancelURL,line_items:l,metadata:{...a,assistanceMessage:a.assistanceMessage||""}},n=new XMLHttpRequest;n.open("POST","https://x8ki-letl-twmt.n7.xano.io/api:lRsgmoHt/sessions"),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(n.status===200){let e=JSON.parse(n.responseText);e&&e.id?window.location.href=e.url:t&&(t.textContent="Invalid response received from server.",t.style.display="block")}else{let e=JSON.parse(n.responseText);t&&(t.textContent=e.message||"An error occurred.",t.style.display="block")}r&&(r.style.display="none")}},n.send(JSON.stringify(g))}function I(){let c=document.querySelector(".toggle-text");o.checked?c.textContent="Yes":c.textContent="No";let s=document.getElementById("messageWrapper");s&&(o.checked?s.style.height="12rem":s.style.height="")}})();
