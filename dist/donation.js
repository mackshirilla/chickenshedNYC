"use strict";(()=>{var y=document.getElementById("submitDonationButton");y&&y.addEventListener("click",S);var E=document.getElementById("recurringToggle");E&&E.addEventListener("change",w);var h=document.getElementById("custom");h&&h.addEventListener("change",f);var I=document.getElementById("customAmount");I&&I.addEventListener("input",b);function S(n){n.preventDefault();let s=document.querySelector("#wf-form-donationForm"),t=new FormData(s);console.log("Form Data:",Object.fromEntries(t));let c=t.get("donationSelected"),g=t.get("customAmount"),l=!!t.get("recurring"),M=t.get("paymentType"),T=!!t.get("anonymous"),L=t.get("sendGridFollowUpID"),k=t.get("sendGridContactListID"),H=t.get("campaign"),u={price_id:"",product_id:"",anonymous:T.toString(),paymentType:M,customAmount:g,recurring:l,checkoutCategory:"donation",sendGridFollowUpID:L,sendGridContactList:k,campaign:H};console.log("Metadata:",u);let i=[];if(c==="custom"){if(!g){let r=document.getElementById("donationProductError");r.style.display="block",r.textContent="Please enter a custom donation amount.";return}i.push({price_id:"",quantity:1});let e=document.getElementById("customMask");e.style.height="5rem";let o=document.getElementById("recurringMask");o.style.height=""}else{if(!c){let a=document.getElementById("donationProductError");a.style.display="block",a.textContent="Please select a donation amount.";return}let e=document.querySelector('input[name="donationSelected"]:checked'),o=e.getAttribute("price_id"),r=e.getAttribute("product_id");if(!o||!r){console.error("Price ID or product ID not found for the selected donation product.");return}i.push({price_id:o,quantity:1}),u.product_id=r,u.price_id=o;let A=document.getElementById("customMask");if(A.style.height="",l){let a=document.getElementById("recurringMask");a.style.height="5rem";let p=!1;document.querySelectorAll('input[name="paymentType"]').forEach(v=>{v.checked&&(p=!0)});let d=document.getElementById("donationRecurringError");if(p)d.style.display="none";else{d.style.display="block",d.textContent="Please select a recurring payment type.";return}}else{let a=document.getElementById("recurringMask");a.style.height=""}}let B={success_url:document.getElementById("success_url").value,cancel_url:window.location.href,line_items:i.map(e=>({price:e.price_id,quantity:e.quantity})),metadata:u},m=document.getElementById("loadingWrapper");if(m.style.display="block",l&&!u.paymentType){let e=document.getElementById("donationRecurringError");e.style.display="block",e.textContent="Please select a recurring payment type.",m.style.display="none";return}fetch("https://xszy-vp96-kdkh.n7c.xano.io/api:lRsgmoHt/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)}).then(e=>{if(!e.ok)throw new Error("Request failed.");return e.json()}).then(e=>{let{url:o}=e;window.location.href=o}).catch(e=>{console.error("An error occurred:",e);let o=document.getElementById("requestError"),r=e.response?e.response.message:"Oops! Something went wrong while submitting the form.";o.style.display="block",o.textContent=r}).finally(()=>{m.style.display="none"})}function w(n){let s=n.target,t=document.getElementById("recurringMask");s.checked?t.style.height="5rem":t.style.height=""}var C=document.querySelectorAll('input[name="donationSelected"]');C.forEach(n=>{n.addEventListener("change",f)});function f(n){let s=n.target,t=document.getElementById("customMask"),c=document.getElementById("customAmount");s.value==="custom"?t.style.height="5rem":(t.style.height="",c.value="")}function b(n){let t=n.target.value,c=document.getElementById("metadataCustomAmount");c&&(c.value=t)}var q=document.querySelectorAll('.switch input[type="checkbox"]');q.forEach(function(n){n.addEventListener("click",function(){let s=this.parentNode;s.classList.toggle("checked");let t=s.querySelector(".toggle-text");t&&(this.checked?t.textContent="Yes":t.textContent="No")})});})();
