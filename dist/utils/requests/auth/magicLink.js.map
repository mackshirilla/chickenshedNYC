{
  "version": 3,
  "sources": ["../../../../bin/live-reload.js", "../../../../src/utils/requests/auth/magicLink.ts"],
  "sourcesContent": ["new EventSource(`${SERVE_ORIGIN}/esbuild`).addEventListener('change', () => location.reload());\n", "async function magicLink() {\n  const verificationError = document.getElementById('verificationError');\n  const magicToken = new URLSearchParams(window.location.search).get('magic_token');\n\n  if (!magicToken) {\n    if (verificationError) {\n      verificationError.style.display = 'block';\n      verificationError.textContent = 'Uh oh! No Magic Token found. Please log in again.';\n    }\n    return;\n  }\n\n  try {\n    const response = await fetch(\n      'https://x8ki-letl-twmt.n7.xano.io/api:WyQO-hFi/auth/magic-login',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ magic_token: magicToken }),\n      }\n    );\n\n    if (!response.ok) {\n      const responseData = await response.json();\n      if (verificationError) {\n        verificationError.style.display = 'block';\n        verificationError.textContent = responseData.message;\n      }\n    } else {\n      //store authToken from response in localStorage\n      const responseData = await response.json();\n      console.log(responseData);\n      localStorage.setItem('authToken', responseData.authToken);\n      //store first item in profile array in localStorage\n      localStorage.setItem('profile', JSON.stringify(responseData.profile[0]));\n      //store role from response in localStorage\n      localStorage.setItem('role', responseData.role);\n      //redirect to step-2 page\n      //window.location.href = '/create-account/step-2';\n      // if role is guardian redirect to /create-account/step-2 page, else redirect to /student-dashboard\n      if (responseData.role === 'guardian') {\n        window.location.href = '/create-account/step-2';\n      } else {\n        window.location.href = '/student-dashboard';\n      }\n    }\n  } catch (error) {\n    // Handle any errors that may occur during the fetch request\n    console.error(error);\n  }\n}\n\n//run magicLink function on page load\nmagicLink();\n"],
  "mappings": ";;;AAAA,MAAI,YAAY,GAAG,iCAAsB,EAAE,iBAAiB,UAAU,MAAM,SAAS,OAAO,CAAC;;;ACA7F,iBAAe,YAAY;AACzB,UAAM,oBAAoB,SAAS,eAAe,mBAAmB;AACrE,UAAM,aAAa,IAAI,gBAAgB,OAAO,SAAS,MAAM,EAAE,IAAI,aAAa;AAEhF,QAAI,CAAC,YAAY;AACf,UAAI,mBAAmB;AACrB,0BAAkB,MAAM,UAAU;AAClC,0BAAkB,cAAc;AAAA,MAClC;AACA;AAAA,IACF;AAEA,QAAI;AACF,YAAM,WAAW,MAAM;AAAA,QACrB;AAAA,QACA;AAAA,UACE,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,UAClB;AAAA,UACA,MAAM,KAAK,UAAU,EAAE,aAAa,WAAW,CAAC;AAAA,QAClD;AAAA,MACF;AAEA,UAAI,CAAC,SAAS,IAAI;AAChB,cAAM,eAAe,MAAM,SAAS,KAAK;AACzC,YAAI,mBAAmB;AACrB,4BAAkB,MAAM,UAAU;AAClC,4BAAkB,cAAc,aAAa;AAAA,QAC/C;AAAA,MACF,OAAO;AAEL,cAAM,eAAe,MAAM,SAAS,KAAK;AACzC,gBAAQ,IAAI,YAAY;AACxB,qBAAa,QAAQ,aAAa,aAAa,SAAS;AAExD,qBAAa,QAAQ,WAAW,KAAK,UAAU,aAAa,QAAQ,CAAC,CAAC,CAAC;AAEvE,qBAAa,QAAQ,QAAQ,aAAa,IAAI;AAI9C,YAAI,aAAa,SAAS,YAAY;AACpC,iBAAO,SAAS,OAAO;AAAA,QACzB,OAAO;AACL,iBAAO,SAAS,OAAO;AAAA,QACzB;AAAA,MACF;AAAA,IACF,SAAS,OAAP;AAEA,cAAQ,MAAM,KAAK;AAAA,IACrB;AAAA,EACF;AAGA,YAAU;",
  "names": []
}
